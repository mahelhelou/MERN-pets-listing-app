(()=>{var e={142:e=>{"use strict";e.exports=require("dotenv")},860:e=>{"use strict";e.exports=require("express")},13:e=>{"use strict";e.exports=require("mongodb")},738:e=>{"use strict";e.exports=require("multer")},109:e=>{"use strict";e.exports=require("sanitize-html")}},t={};function s(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,s),a.exports}(()=>{const e=s(860),t=(s(142).config(),s(738)()),n=s(109),i=process.env.POrt||8e3,{MongoClient:a,ObjectId:o}=s(13);let r;const c=e();c.set("view engine","ejs"),c.set("views","./views"),c.use(e.static("public")),c.use(e.json()),c.use(e.urlencoded({extended:!1})),c.get("/",(async(e,t)=>{const s=await r.collection("animals").find().toArray();t.render("home",{animals:s})})),c.use(((e,t,s)=>{t.set("WWW-Authenticate","Basic realm='MERN Pets Listing App'"),"Basic YWRtaW46YWRtaW4="===e.headers.authorization?s():t.status(401).send("Invalid credentials! Try again.")})),c.get("/admin",((e,t)=>{t.render("admin")})),c.get("/api/animals",(async(e,t)=>{const s=await r.collection("animals").find().toArray();t.json(s)})),c.post("/create-animal",t.single("photo"),(function(e,t,s){"string"!=typeof e.body.name&&(e.body.name=""),"string"!=typeof e.body.species&&(e.body.species=""),"string"!=typeof e.body._id&&(e.body._id=""),e.cleanData={name:n(e.body.name,{allowedTags:[],allowedAttributes:{}}),species:n(e.body.species,{allowedTags:[],allowedAttributes:{}})},s()}),(async(e,t)=>{console.log(e.body);const s=await r.collection("animals").insertOne(e.cleanData),n=await r.collection("animals").findOne({_id:new o(s.insertedId)});t.json(n)})),(async()=>{const e=new a(process.env.CONNECTION_STRING);e.connect(),r=await e.db(),c.listen(i)})()})()})();